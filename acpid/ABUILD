# ABUILD generated by mkpkg_generator.sh

pkgname=acpid
pkgver=1.0.10
pkgbuild=3
arch=('auto')

shortdesc=('acpid (ACPI daemon)')
longdesc=('Most modern computers support the Advanced Configuration and Power Interface (ACPI) standard to allow intelligent power management. This package contains acpid, which is the user-space daemon needed in order to make the Linux ACPI support completely functional. ACPI must be compiled into the kernel to run acpid.')

tags=('base sys-power')

source=("http://downloads.sourceforge.net/project/acpid/acpid/${pkgver}/acpid-${pkgver}.tar.gz")

build_deps='glibc-solibs'


build() {
	go_src_dir
	burn_patches

	make || exit 1
	strip acpid acpi_listen
	mkdir -p $pkgdir/usr/sbin
	cat acpid > $pkgdir/usr/sbin/acpid
	chmod 755 $pkgdir/usr/sbin/acpid
	mkdir -p $pkgdir/usr/bin
	cat acpi_listen > $pkgdir/usr/bin/acpi_listen
	chmod 755 $pkgdir/usr/bin/acpi_listen
	mkdir -p $pkgdir/usr/man/man8
	cat acpid.8 | gzip -9c > $pkgdir/usr/man/man8/acpid.8.gz
	cat acpi_listen.8 | gzip -9c > $pkgdir/usr/man/man8/acpi_listen.8.gz
	mkdir -p $pkgdir/etc/acpi/events
	zcat $filedir/acpi_handler.sh.gz > $pkgdir/etc/acpi/acpi_handler.sh.new
	chmod 755 $pkgdir/etc/acpi/acpi_handler.sh.new
	zcat $filedir/default.gz > $pkgdir/etc/acpi/events/default
	
	# Add OpenRC scripts
	mkdir -p $pkgdir/etc/conf.d
	install -m644 $filedir/acpid $pkgdir/etc/conf.d/acpid.new
	mkdir -p $pkgdir/etc/init.d
	install -m755 $filedir/acpid.init $pkgdir/etc/init.d/acpid

}

