# ABUILD generated by spkg2abuild converter from lxdm-0.2.0_svnREVISION-3.spkg

# Package metadata
pkgname=lxdm
pkgver=0.4.2
pkgbuild=1
arch="auto"

# Package description
shortdesc=("Display manager from LXDE project")
longdesc=("LXDM is the lightweight display manager aimed to replace gdm in LXDE distros. The UI is implemented with GTK+. LXDM was started by 'dgod' from China and is developed by the LXDE community. For some time it only worked smoothly with Fedora while on Ubuntu and others, there might have been some issues.")

# Source URL
source=("svn:https://lxde.svn.sourceforge.net/svnroot/lxde/trunk/lxdm/")
# Tags
tags="xapps x11-misc"

# Manually-added dependencies
adddep=""

before_build() {
    ./autogen.sh
}

# Build system
BUILD_SYSTEM="autotools"
BUILD_KEYS="--prefix=/usr \
--bindir=/usr/bin \
--sbindir=/usr/sbin \
--includedir=/usr/include \
--mandir=/usr/man \
--infodir=/usr/info \
--libdir=/usr/lib${LIBDIRSUFFIX} \
--sysconfdir=/etc \
--localstatedir=/var \
--libexecdir=/usr/lib${LIBDIRSUFFIX}/lxdm"

config_files="etc/lxdm/lxdm.conf
etc/pam.d/lxdm"


after_build() {
	echo ""
    install -d ${pkgdir}/var/{lib,run}/lxdm
	mkdir -p ${pkgdir}/etc/init.d
	cat ${filedir}/lxdm.init > ${pkgdir}/etc/init.d/lxdm
	chmod 755 ${pkgdir}/etc/init.d/lxdm
	cat ${filedir}/Xsession > ${pkgdir}/etc/lxdm/Xsession
	chmod 755 ${pkgdir}/etc/lxdm/Xsession
	sed -i "s/local\/libexec/lib$LIBDIRSUFFIX\/lxdm/g" $pkgdir/etc/lxdm/lxdm.conf
	cat ${filedir}/lxdm.pam > ${pkgdir}/etc/pam.d/lxdm
}

