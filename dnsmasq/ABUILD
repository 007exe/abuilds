# ABUILD generated by mkpkg_generator.sh

pkgname=dnsmasq
pkgver=2.55
pkgbuild=1
arch=("auto")

shortdesc=("dnsmasq (small DNS and DHCP server)")
longdesc=("Dnsmasq is a lightweight, easy to configure DNS forwarder and DHCP server. It is designed to provide DNS (and optionally DHCP) to a small network, and can serve the names of local machines which are not in the global DNS. Dnsmasq was written by Simon Kelley.")

tags=("net-dns network")

source=("http://www.thekelleys.org.uk/$pkgname/$pkgname-$pkgver.tar.gz")

config_files="etc/conf.d/dnsmasq
etc/dnsmasq.conf"

build() {
	go_src_dir
	burn_patches

	set -e
	make -j${numjobs}
	make PREFIX=/usr DESTDIR=${pkgdir} install

	install -D -m0755 ${filedir}/dnsmasq-init ${pkgdir}/etc/init.d/dnsmasq
	install -D -m0644 ${filedir}/dnsmasq.confd ${pkgdir}/etc/conf.d/dnsmasq
	install -D -m0644 dnsmasq.conf.example ${pkgdir}/etc/dnsmasq.conf

	# Required dirs for DHCP
	install -d ${pkgdir}/var/db
	install -d ${pkgdir}/var/lib/misc

	set +e

}
