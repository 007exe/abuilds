# ABUILD generated by mkpkg_generator.sh

pkgname=wicd
pkgver=1.7.0
pkgbuild=4
arch=("auto")

shortdesc=("wicd (network manager for linux)")
longdesc=("wicd is a wired and wireless network manager for Linux. Some features include: - Ability to connect to wired and wireless networks - Profiles for each wireless network and wired network - Many encryption schemes, some of which include WEP/WPA/WPA2 - Compatible with wireless-tools Homepage: http://wicd.net")

tags=("net-misc network")

source=("http://downloads.sourceforge.net/sourceforge/$pkgname/$pkgname-$pkgver.tar.gz")

build_deps="python"
adddep="dhcpcd pygtk dbus dbus-python wireless-tools wpa_supplicant shared-mime-info ethtool ConsoleKit"

build() {
	go_src_dir
	burn_patches
	set -e
	python setup.py configure --no-install-init --resume=/usr/share/wicd/scripts/ \
                            --suspend=/usr/share/wicd/scripts/ --verbose --python=/usr/bin/python

	python setup.py install --root=$pkgdir

	install -Dm755 ${filedir}/wicd.init $pkgdir/etc/init.d/wicd
	install -Dm644 ${filedir}/wicd.desktop $pkgdir/usr/share/applications/wicd.desktop

	cd build/lib/wicd
	for i in *.py; do
		install -Dm 755 $i $pkgdir/usr/lib${LIBDIRSUFFIX}/wicd/$i
	done
  
	# This sets dhcpcd as the default dhcp client in the Preferences dialog
cat << EOF > ${pkgdir}/etc/wicd/manager-settings.conf.new
[Settings]
dhcp_client = 2
EOF
	rm -rf $pkgdir/usr/share/autostart
	set +e
}
