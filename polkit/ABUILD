pkgname=polkit
pkgver=0.104
pkgbuild=1
arch="auto"

shortdesc=("Authorization Framework")
source=("http://hal.freedesktop.org/releases/polkit-${pkgver}.tar.gz")

tags="libs sys-auth"

build_deps="make gcc grep binutils intltool gettext perl perl-xml-parser gtk-doc pkg-config coreutils expat glib2 gobject-introspection"

build(){
  go_src_dir
  ./configure --prefix=/usr \
              --sbindir=/usr/sbin \
              --mandir=/usr/man \
              --libdir=/usr/lib${LIBDIRSUFFIX} \
              --libexecdir=/usr/lib${LIBDIRSUFFIX}/polkit-1 \
              --sysconfdir=/etc \
              --localstatedir=/var \
              --enable-gtk-doc \
              --disable-gtk-doc-html \
              --disable-static \
              --enable-libsystemd-login=yes

  make
  make DESTDIR=${pkgdir} install || echo "11111111"
}

after_build() {
  install -m644 "${filedir}/polkit.pam" "${pkgdir}/etc/pam.d/polkit-1"
  echo "End after_build"
}

