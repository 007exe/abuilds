# ABUILD generated by mkpkg_generator.sh

pkgname=distcc
pkgver=3.1
pkgbuild=2
arch=('auto')

shortdesc=('distcc (distributed C/C++ compiler/daemon)')
longdesc=('distcc allows compilation of C code to be distributed across several machines on a network. distcc should always generate the same results as a local compile, is simple to install and use, and is often significantly faster than a local compile. IMPORTANT SECURITY NOTE: distccd should only run on trusted networks. distcc was written by Martin Pool.')

tags=('develop sys-devel')

source=("http://distcc.googlecode.com/files/${pkgname}-${pkgver}.tar.bz2")

gendeps_blacklist="usr/bin/distccmon-gnome"
BUILD_SYSTEM='autotools'
BUILD_KEYS="--prefix=/usr \
	--with-gtk \
	--sysconfdir=/etc \
	--libdir=/usr/lib$LIBDIRSUFFIX \
	--mandir=/usr/man"

INSTALL_KEYS="DESTDIR=$pkgdir"

after_build() {
	mkdir -p ${pkgdir}/etc/{init.d,conf.d}
	install -m755 ${filedir}/distccd.init ${pkgdir}/etc/init.d/distccd
	install -m644 ${filedir}/distccd.conf.d ${pkgdir}/etc/conf.d/distccd

	mkdir -p ${pkgdir}/usr/lib${LIBDIRSUFFIX}/distcc/bin
	for i in ${filedir}/bin/* ; do
		install -m755 $i ${pkgdir}/usr/lib${LIBDIRSUFFIX}/distcc/bin/`basename $i`
	done
}

